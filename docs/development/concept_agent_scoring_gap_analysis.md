# Concept Agent 评分系统差异分析报告

## 📅 日期：2025-07-18

## 🎯 问题概述

在Day 6开始前的核对中，发现当前实现的评分系统与原始设计存在重大偏差，特别是**公告、互动平台、年报搜索功能完全缺失**。

## 📊 评分体系对比

### 原始设计（初步设计文档）

```python
# 总分100分，分为4个维度
- 软件收录权重（40分）
  - 东财收录：15分
  - 同花顺收录：15分
  - 其他软件：10分
  
- 财报证据权重（30分）
  - 年报提及：15分
  - 季报提及：15分
  
- 互动平台权重（20分）
  - 董秘确认：20分
  
- 公告证据权重（10分）
  - 临时公告：10分
```

### 当前实现

```python
# 总分100分，但维度完全不同
- 概念关联度（40分）
  - 在成分股表中：20分
  - 多数据源验证：10分
  - 板块率先涨停：5分
  - 财报/公告/互动：5分（但实际未实现）
  
- 资金流向（30分）
  - 基础分：10分
  - 日/周净流入：各5分
  - 排名和连续性：10分
  
- 技术形态（30分）
  - 基础分：10分
  - MACD状态：10分
  - 均线排列：10分
```

## 🔍 缺失功能分析

### 1. 财报搜索功能

**原始需求**：
- 在年报/季报中搜索概念关键词
- 提取相关业务描述作为证据
- 根据提及程度给出15分评分

**实现状态**：
- ❌ 未实现
- 代码中的`financial_report_mention`字段无数据来源
- 需要集成RAG系统进行年报搜索

### 2. 互动平台搜索

**原始需求**：
- 搜索董秘问答中的概念确认
- 提取董秘回复内容作为证据
- 确认即得20分

**实现状态**：
- ❌ 未实现
- 代码中的`interaction_mention`字段无数据来源
- 需要查询互动平台数据表

### 3. 公告搜索功能

**原始需求**：
- 在临时公告中搜索概念相关内容
- 提取公告标题和内容作为证据
- 相关即得10分

**实现状态**：
- ❌ 未实现
- 代码中的`announcement_mention`字段无数据来源
- 需要集成RAG系统进行公告搜索

### 4. 证据收集系统

**原始需求**：
```python
evidence_list = [
    {
        'type': '软件收录',
        'source': '东财',
        'content': '东财储能概念成分股',
        'score': 15
    },
    {
        'type': '财报',
        'source': '2024年年报',
        'content': '公司储能业务收入占比达到...',
        'score': 15
    },
    # ...
]
```

**实现状态**：
- ❌ 未实现证据收集
- 当前只有分数，没有具体证据
- 用户无法知道为什么这个股票被认为是概念股

## 🚨 影响分析

### 1. 功能完整性
- 当前系统**无法提供概念关联的事实依据**
- 违背了"基于事实驱动"的核心设计原则
- 用户无法验证概念股的真实性

### 2. 评分准确性
- 当前评分主要基于技术指标和资金流向
- 缺少最重要的概念关联度实质评分
- 可能导致非概念股因技术形态好而排名靠前

### 3. 用户体验
- 用户看不到为什么某股票是概念股
- 缺少透明度和可信度
- 无法满足"基于事实"的核心价值主张

## 💡 解决方案

### 方案一：快速修补（1-2天）
1. 先使用现有数据完成基础功能
2. 将财报/互动/公告搜索标记为"待实现"
3. 调整评分权重，暂时加大技术指标权重

### 方案二：完整实现（3-5天）
1. 集成RAG系统实现年报搜索
2. 查询互动平台数据表
3. 集成公告搜索功能
4. 实现完整的证据收集系统
5. 按原始设计重构评分体系

### 方案三：分阶段实现（推荐）
1. **Phase 1**（Day 6）：基础功能优化
   - 优化现有评分系统
   - 实现基础证据收集（数据源信息）
   - 完成性能优化

2. **Phase 2**（Day 7-8）：集成搜索功能
   - 集成RAG进行年报搜索
   - 实现公告搜索
   - 查询互动平台数据

3. **Phase 3**（Day 9-10）：完整评分体系
   - 重构评分系统
   - 实现证据展示
   - 完善用户体验

## 📝 建议

1. **立即行动**：
   - 与用户确认是否需要完整实现原始设计
   - 评估RAG集成的技术可行性
   - 确认互动平台数据表结构

2. **风险提示**：
   - 不实现证据系统将严重影响产品价值
   - 可能需要延长开发时间
   - 需要额外的系统集成工作

3. **优先级建议**：
   - P0：实现基础的证据展示（哪个数据源）
   - P1：集成年报搜索（最重要的证据）
   - P2：集成互动平台和公告搜索

## 🎯 决策需求

请确认：
1. 是否需要完整实现原始设计的4维度评分体系？
2. 是否可以接受分阶段实现？
3. 是否有现成的互动平台数据表可以查询？
4. RAG系统是否支持指定股票代码的年报搜索？