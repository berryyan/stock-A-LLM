# 网页版功能测试指南 v1.4.2

**文档版本**: v1.4.2  
**更新日期**: 2025-06-24  
**适用系统**: 股票分析智能系统网页版  
**测试环境**: http://localhost:8000  

## 📋 目录

1. [测试概述](#测试概述)
2. [测试环境准备](#测试环境准备)
3. [核心功能测试](#核心功能测试)
4. [破坏性测试](#破坏性测试)
5. [性能测试](#性能测试)
6. [用户体验测试](#用户体验测试)
7. [边界条件测试](#边界条件测试)
8. [回归测试清单](#回归测试清单)
9. [测试报告模板](#测试报告模板)

## 测试概述

### 测试目标
- 验证所有核心业务功能在网页版中正常工作
- 确保前端界面与后端API的完整集成
- 验证用户交互体验的完整性
- 发现脚本测试无法覆盖的UI层面问题

### 测试范围
- ✅ 所有核心查询功能（SQL、RAG、混合查询）
- ✅ 专业财务分析功能（v1.4.0）
- ✅ 资金流向分析功能（Phase 2）
- ✅ 智能日期解析功能（v1.4.1）
- ✅ 前端界面交互和响应
- ✅ 错误处理和用户提示
- ✅ 数据完整性和准确性

## 测试环境准备

### 前置条件
1. **API服务器启动**:
   ```bash
   python -m uvicorn api.main:app --reload --host 0.0.0.0 --port 8000
   ```

2. **数据库连接正常**:
   - MySQL (10.0.0.77:3306)
   - Milvus (10.0.0.77:19530)

3. **环境变量配置**:
   - DEEPSEEK_API_KEY 已设置
   - 数据库连接参数正确

### 测试工具
- 浏览器：Chrome/Firefox/Safari
- 开发者工具：网络监控、控制台日志
- 计时器：测试响应时间

## 核心功能测试

### 1. 基础查询功能测试

#### 1.1 SQL查询测试
**测试目标**: 验证结构化数据查询功能

| 测试用例 | 查询内容 | 预期结果 | 响应时间要求 |
|---------|---------|---------|------------|
| SQL-001 | "贵州茅台最新股价" | 返回最新交易日股价数据 | < 30秒 |
| SQL-002 | "A股市值排名前10" | 返回市值排序列表 | < 45秒 |
| SQL-003 | "平安银行最近5日股价" | 返回5日历史数据 | < 25秒 |
| SQL-004 | "比亚迪今年涨幅" | 返回年度涨跌幅 | < 30秒 |

**测试步骤**:
1. 打开网页版界面 (http://localhost:8000)
2. 在输入框中输入测试查询
3. 点击发送按钮或按Enter键
4. 观察响应时间和结果准确性
5. 验证返回格式是否用户友好

#### 1.2 RAG查询测试
**测试目标**: 验证文档语义搜索功能

| 测试用例 | 查询内容 | 预期结果 | 响应时间要求 |
|---------|---------|---------|------------|
| RAG-001 | "贵州茅台最新公告内容" | 返回相关公告文档 | < 40秒 |
| RAG-002 | "平安银行风险管理策略" | 返回风险管理相关内容 | < 35秒 |
| RAG-003 | "茅台股东大会决议" | 返回股东大会相关文档 | < 40秒 |
| RAG-004 | "比亚迪新能源战略" | 返回新能源相关内容 | < 35秒 |

#### 1.3 混合查询测试
**测试目标**: 验证智能路由和组合查询

| 测试用例 | 查询内容 | 预期结果 | 响应时间要求 |
|---------|---------|---------|------------|
| HYB-001 | "分析茅台的投资价值" | SQL+RAG组合分析 | < 60秒 |
| HYB-002 | "平安银行基本面如何" | 财务数据+文档分析 | < 55秒 |
| HYB-003 | "比亚迪发展前景分析" | 多维度综合分析 | < 65秒 |

### 2. 专业财务分析测试 (v1.4.0)

#### 2.1 财务健康度评分测试

| 测试用例 | 查询内容 | 预期结果 | 验证要点 |
|---------|---------|---------|---------|
| FIN-001 | "分析贵州茅台的财务健康度" | 返回AAA-CCC评级 | 四维度评分完整 |
| FIN-002 | "平安银行财务健康度" | 返回银行业财务评级 | 适配银行业特点 |
| FIN-003 | "万科财务健康度评分" | 返回房地产业评级 | 行业特点体现 |

**详细验证要点**:
- 总评级 (AAA、AA、A、BBB、BB、B、CCC)
- 四个维度评分：盈利能力、偿债能力、运营能力、成长能力
- 具体数值和计算逻辑说明
- LLM分析报告的专业性

#### 2.2 杜邦分析测试

| 测试用例 | 查询内容 | 预期结果 | 验证要点 |
|---------|---------|---------|---------|
| DUP-001 | "茅台杜邦分析" | ROE分解分析 | 三因子分解完整 |
| DUP-002 | "平安银行杜邦分析" | 银行ROE分析 | 适配银行业模式 |
| DUP-003 | "比亚迪杜邦分析" | 制造业ROE分析 | 资产周转率分析 |

**验证要点**:
- ROE = 净利率 × 资产周转率 × 权益乘数
- 各因子的具体数值和趋势
- 多期对比分析
- 行业对比和评价

#### 2.3 现金流质量分析测试

| 测试用例 | 查询内容 | 预期结果 | 验证要点 |
|---------|---------|---------|---------|
| CAS-001 | "茅台现金流质量分析" | 现金流质量评级 | 现金含量比率 |
| CAS-002 | "万科现金流质量" | 房地产现金流特点 | 稳定性评分 |
| CAS-003 | "比亚迪现金流分析" | 制造业现金流 | 综合质量评级 |

### 3. 资金流向分析测试 (Phase 2)

#### 3.1 主力资金分析测试

| 测试用例 | 查询内容 | 预期结果 | 响应时间要求 |
|---------|---------|---------|------------|
| MON-001 | "茅台最近30天资金流向" | 30天资金流向分析报告 | < 120秒 |
| MON-002 | "平安银行资金流向分析" | 银行股资金流向 | < 100秒 |
| MON-003 | "比亚迪资金流向" | 制造业资金流向 | < 110秒 |

**验证要点**:
- 主力资金净流入/流出
- 超大单、大单、中单、小单分布
- 资金流向趋势分析
- 专业投资建议

#### 3.2 资金流向对比测试

| 测试用例 | 查询内容 | 预期结果 | 验证要点 |
|---------|---------|---------|---------|
| MON-004 | "对比茅台和五粮液资金流向" | 两股资金流向对比 | 相对强弱分析 |
| MON-005 | "银行股资金流向对比" | 银行板块资金分析 | 板块轮动分析 |

### 4. 智能日期解析测试 (v1.4.1)

#### 4.1 时间表达识别测试

| 测试用例 | 查询内容 | 预期行为 | 验证要点 |
|---------|---------|---------|---------|
| DAT-001 | "茅台最新股价" | 自动解析为最近交易日 | 时间点准确性 |
| DAT-002 | "贵州茅台最近公告" | 自动解析为最新公告日期 | 数据类型匹配 |
| DAT-003 | "平安银行现在的财务数据" | 自动解析为最新报告期 | 报告期准确性 |
| DAT-004 | "比亚迪今年表现" | 自动解析为年度数据 | 时间段处理 |

**验证要点**:
- 时间表达自动识别准确性
- 不同数据类型的时间需求匹配
- 非交易日的智能处理
- 缓存机制的有效性

## 破坏性测试

### 1. 异常输入测试

#### 1.1 无效查询测试

| 测试用例 | 输入内容 | 预期结果 | 验证要点 |
|---------|---------|---------|---------|
| ERR-001 | 空字符串 | 友好错误提示 | 输入验证 |
| ERR-002 | 纯空格 | 友好错误提示 | 空白处理 |
| ERR-003 | 特殊字符 "!@#$%^&*()" | 正常处理或友好提示 | 特殊字符处理 |
| ERR-004 | 超长文本 (>1000字符) | 截断或友好提示 | 长度限制 |
| ERR-005 | SQL注入尝试 | 安全过滤 | 安全防护 |

#### 1.2 不存在的股票代码测试

| 测试用例 | 输入内容 | 预期结果 | 验证要点 |
|---------|---------|---------|---------|
| ERR-006 | "999999.SH股价" | 友好错误提示 | 代码验证 |
| ERR-007 | "不存在的公司股价" | 智能建议相似公司 | 模糊匹配 |
| ERR-008 | "AAPL股价" | 提示仅支持A股 | 市场范围说明 |

### 2. 网络异常测试

#### 2.1 API连接异常测试

| 测试场景 | 模拟方法 | 预期结果 | 验证要点 |
|---------|---------|---------|---------|
| NET-001 | 断开网络连接 | 连接失败提示 | 网络错误处理 |
| NET-002 | API服务器重启 | 自动重试或友好提示 | 服务异常处理 |
| NET-003 | 数据库连接失败 | 系统错误提示 | 数据库异常处理 |

### 3. 边界条件测试

#### 3.1 数据边界测试

| 测试用例 | 查询内容 | 预期结果 | 验证要点 |
|---------|---------|---------|---------|
| BND-001 | 查询历史上市首日数据 | 正确返回或无数据提示 | 历史数据边界 |
| BND-002 | 查询未来日期数据 | 友好提示未来无数据 | 未来数据处理 |
| BND-003 | 查询停牌股票数据 | 正确显示停牌状态 | 特殊状态处理 |

## 性能测试

### 1. 响应时间测试

#### 1.1 标准响应时间基准

| 查询类型 | 目标响应时间 | 可接受范围 | 超时阈值 |
|---------|-------------|------------|----------|
| 简单SQL查询 | < 15秒 | < 30秒 | 60秒 |
| 复杂SQL查询 | < 30秒 | < 45秒 | 90秒 |
| RAG查询 | < 25秒 | < 40秒 | 80秒 |
| 财务分析 | < 45秒 | < 60秒 | 120秒 |
| 资金流向分析 | < 90秒 | < 120秒 | 180秒 |
| 混合查询 | < 60秒 | < 90秒 | 150秒 |

#### 1.2 性能压力测试

| 测试场景 | 测试方法 | 预期结果 | 验证要点 |
|---------|---------|---------|---------|
| PER-001 | 连续10次相同查询 | 缓存机制生效 | 响应时间递减 |
| PER-002 | 同时打开多个标签页查询 | 并发处理正常 | 资源竞争处理 |
| PER-003 | 长时间连续查询 | 性能稳定 | 内存泄漏检查 |

### 2. 用户体验测试

#### 2.1 界面交互测试

| 测试项目 | 测试内容 | 预期结果 | 验证要点 |
|---------|---------|---------|---------|
| UI-001 | 页面加载速度 | < 3秒完全加载 | 首屏加载时间 |
| UI-002 | 输入框响应 | 实时输入反馈 | 交互流畅度 |
| UI-003 | 按钮点击响应 | 立即视觉反馈 | 用户反馈及时性 |
| UI-004 | 打字指示器 | 查询时显示 | 状态指示准确性 |
| UI-005 | 结果展示格式 | 易读性良好 | 信息展示质量 |

#### 2.2 快捷操作测试

| 测试项目 | 操作方法 | 预期结果 | 验证要点 |
|---------|---------|---------|---------|
| QCK-001 | 点击"茅台财务分析"按钮 | 自动填入并执行 | 快捷操作有效性 |
| QCK-002 | 点击"茅台资金流向"按钮 | 自动填入并执行 | 预设查询准确性 |
| QCK-003 | 点击"平安技术分析"按钮 | 自动填入并执行 | 按钮功能完整性 |
| QCK-004 | 点击"市值排行榜"按钮 | 自动填入并执行 | 数据查询正确性 |

#### 2.3 移动端适配测试

| 测试项目 | 测试设备 | 预期结果 | 验证要点 |
|---------|---------|---------|---------|
| MOB-001 | 手机浏览器 | 响应式布局正常 | 移动端适配 |
| MOB-002 | 平板浏览器 | 界面缩放合适 | 中等屏幕适配 |
| MOB-003 | 横屏模式 | 布局自适应 | 方向适配 |

## 回归测试清单

### 每次发布前必测项目

#### 基础功能验证 (15分钟)
- [ ] 首页加载正常
- [ ] API文档访问正常 (http://localhost:8000/docs)
- [ ] 健康检查正常 (http://localhost:8000/health)
- [ ] 基础SQL查询："贵州茅台最新股价"
- [ ] 基础RAG查询："贵州茅台最新公告"
- [ ] 错误处理：输入空字符串

#### 核心功能验证 (30分钟)
- [ ] 财务分析功能："分析贵州茅台的财务健康度"
- [ ] 资金流向分析："茅台最近30天资金流向"
- [ ] 智能日期解析："茅台最新股价"
- [ ] 公司对比功能："对比茅台和五粮液"
- [ ] 混合查询功能："分析茅台的投资价值"

#### 性能和稳定性验证 (20分钟)
- [ ] 响应时间在可接受范围内
- [ ] 连续查询5次无异常
- [ ] 界面交互流畅度
- [ ] 移动端基础适配

### 重大更新后深度测试清单

#### 完整功能测试 (60分钟)
- [ ] 执行所有核心功能测试用例
- [ ] 执行所有破坏性测试用例
- [ ] 执行性能测试基准验证
- [ ] 执行用户体验完整测试

#### 数据一致性验证 (30分钟)
- [ ] 脚本测试结果与网页版对比
- [ ] 数据库查询结果一致性验证
- [ ] 缓存数据准确性验证
- [ ] 文档检索结果一致性验证

## 测试报告模板

### 测试执行报告

```markdown
# 网页版功能测试报告

**测试版本**: v1.4.2
**测试日期**: 2025-06-24
**测试人员**: [测试人员姓名]
**测试环境**: Windows 10 + Chrome 120

## 测试摘要
- 测试用例总数: [总数]
- 通过用例数: [通过数]
- 失败用例数: [失败数]
- 成功率: [成功率%]

## 测试结果详情

### 核心功能测试
| 功能模块 | 测试用例数 | 通过数 | 失败数 | 成功率 |
|---------|-----------|-------|-------|--------|
| SQL查询 | 4 | 4 | 0 | 100% |
| RAG查询 | 4 | 4 | 0 | 100% |
| 财务分析 | 6 | 6 | 0 | 100% |
| 资金流向 | 5 | 5 | 0 | 100% |
| 智能日期 | 4 | 4 | 0 | 100% |

### 性能测试结果
| 查询类型 | 平均响应时间 | 最大响应时间 | 是否达标 |
|---------|-------------|-------------|----------|
| SQL查询 | 18.5秒 | 25.3秒 | ✅ |
| RAG查询 | 28.2秒 | 35.8秒 | ✅ |
| 财务分析 | 42.7秒 | 52.1秒 | ✅ |
| 资金流向 | 95.3秒 | 115.2秒 | ✅ |

### 发现的问题
1. [问题描述]
   - 严重程度: [高/中/低]
   - 影响范围: [具体描述]
   - 建议处理: [处理建议]

## 测试结论
[整体评估和建议]
```

## 测试工具和脚本

### 自动化测试脚本建议

```python
# 建议创建 web_automation_test.py
# 使用 Selenium 自动化网页版测试

# 功能测试自动化
def test_basic_sql_query():
    # 自动化测试基础SQL查询
    pass

def test_financial_analysis():
    # 自动化测试财务分析功能
    pass

# 性能测试自动化
def test_response_time():
    # 自动化测试响应时间
    pass
```

### 测试数据管理

```python
# 测试用例数据文件 test_cases.json
{
    "sql_queries": [
        {"input": "贵州茅台最新股价", "expected_type": "sql", "timeout": 30},
        {"input": "A股市值排名前10", "expected_type": "sql", "timeout": 45}
    ],
    "rag_queries": [
        {"input": "贵州茅台最新公告", "expected_type": "rag", "timeout": 40}
    ]
}
```

## 持续改进建议

### 1. 测试覆盖率提升
- 定期分析测试盲点
- 新功能开发同步增加测试用例
- 用户反馈问题转化为测试用例

### 2. 自动化测试发展
- 逐步引入Selenium自动化测试
- 建立CI/CD自动化测试流程
- 定期执行回归测试

### 3. 性能基准更新
- 定期更新性能基准
- 监控性能趋势
- 优化性能瓶颈

---

**文档维护者**: AI Development Team  
**最后更新**: 2025-06-24  
**下一次更新**: 随系统版本更新  