# SQL Agent模板测试用例汇总

**版本**: v2.1.3  
**更新日期**: 2025-06-30  
**说明**: 本文档汇总SQL Agent下所有已实现的查询模板和快速匹配模板，为前端验证提供测试用例

## SQL Agent模板列表

SQL Agent支持两种类型的模板：
1. **快速查询模板**：绕过LLM直接执行SQL，响应时间0.02秒
2. **LLM辅助模板**：需要LLM理解和生成SQL，响应时间5-60秒

### 1. 股价查询模板 (price_query)

**功能**: 查询指定股票在特定日期的股价信息  
**模式**: `(.+?)(?:的)?(?:(\d{8}|\d{4}-\d{2}-\d{2}|\d{4}年\d{2}月\d{2}日|最新|昨天|前天|上个交易日|最近一个交易日))?(?:的)?股价`  
**路由**: SQL_ONLY (快速路径)

#### 正向测试用例（10个）
```
1. 贵州茅台最新股价
2. 平安银行20250627的股价  
3. 中国平安2025-06-27的股价
4. 格力电器2025年06月27日的股价
5. 万科A昨天的股价
6. 比亚迪前天的股价
7. 宁德时代上个交易日的股价
8. 招商银行最近一个交易日的股价
9. 五粮液的股价
10. 601318.SH最新股价
```

#### 错误测试用例（5个）
```
1. 茅台股价（错误：应使用完整名称"贵州茅台"）
2. 600519.sh股价（错误：后缀应为大写.SH）
3. 00001股价（错误：股票代码应为6位数字）
4. 平安股价（错误：有歧义，应明确指定"平安银行"或"中国平安"）
5. 999999.BJ股价（错误：股票不存在）
```

### 2. K线查询模板 (kline_query)

**功能**: 查询股票在指定时间段的K线数据  
**模式**: `(.+?)(?:的)?(?:从(.+?)到(.+?)|最近(\d+)天|过去(\d+)天|最近(\d+)个月|过去(\d+)个月)?的?(?:K线|走势)`  
**路由**: SQL_ONLY (快速路径)

#### 正向测试用例（10个）
```
1. 贵州茅台最近30天K线
2. 平安银行从2025-06-01到2025-06-27的K线
3. 中国平安过去5天的走势
4. 格力电器最近一个月的K线
5. 万科A过去10天的走势
6. 比亚迪最近90天K线
7. 宁德时代过去3个月的K线
8. 招商银行从20250601到20250627的走势
9. 五粮液最近60天的K线走势
10. 601318.SH从2025年06月01日到2025年06月27日的K线
```

#### 错误测试用例（5个）
```
1. 茅台K线（错误：应使用完整名称）
2. 600519最近的K线（错误：缺少具体时间范围）
3. 平安走势（错误：有歧义的简称）
4. 最近K线（错误：缺少股票名称）
5. 从昨天到明天的K线（错误：未来日期无效）
```

### 3. 成交量查询模板 (volume_query)

**功能**: 查询股票的成交量和成交额  
**模式**: `(.+?)(?:的)?(?:(\d{8}|\d{4}-\d{2}-\d{2}|\d{4}年\d{2}月\d{2}日|最新|昨天|上个交易日)|最近(\d+)天|过去(\d+)天)?(?:的)?(?:成交量|交易量|成交额)`  
**路由**: SQL_ONLY (快速路径)

#### 正向测试用例（10个）
```
1. 贵州茅台最新成交量
2. 平安银行昨天的成交量
3. 中国平安20250627的成交额
4. 格力电器2025-06-26的交易量
5. 万科A上个交易日的成交量
6. 比亚迪最近5天的成交量
7. 宁德时代过去10天的成交额
8. 招商银行2025年06月27日的成交量
9. 五粮液的成交额
10. 601318.SH最新交易量
```

#### 错误测试用例（5个）
```
1. 茅台成交量（错误：应使用完整名称）
2. 成交量（错误：缺少股票名称）
3. 600519.sz成交额（错误：后缀应为大写）
4. 平安成交量（错误：有歧义的简称）
5. 明天的成交量（错误：未来日期无效）
```

### 4. 利润查询模板 (profit_query)

**功能**: 查询公司的营收和利润数据  
**模式**: `(.+?)(?:的)?(?:利润|营收|净利润|营业收入)`  
**路由**: SQL_ONLY (LLM路径)

#### 正向测试用例（10个）
```
1. 贵州茅台的净利润
2. 平安银行的营业收入
3. 中国平安的利润
4. 格力电器的营收
5. 万科A的净利润是多少
6. 比亚迪最新净利润
7. 宁德时代的营业收入情况
8. 招商银行利润如何
9. 五粮液的营收数据
10. 601318.SH的净利润
```

#### 错误测试用例（5个）
```
1. 茅台利润（错误：应使用完整名称）
2. 利润（错误：缺少公司名称）
3. 600519.sh净利润（错误：后缀应为大写）
4. 平安营收（错误：有歧义的简称）
5. 999999的利润（错误：股票不存在）
```

### 5. 估值指标查询模板 (valuation_query)

**功能**: 查询PE、PB等估值指标  
**模式**: `(.+?)(?:的)?(?:(\d{8}|\d{4}-\d{2}-\d{2}|\d{4}年\d{2}月\d{2}日|最新|昨天|上个交易日))?(?:的)?(?:PE|PB|市盈率|市净率|估值)`  
**路由**: SQL_ONLY (快速路径)

#### 正向测试用例（10个）
```
1. 贵州茅台的市盈率
2. 平安银行最新PE
3. 中国平安昨天的市净率
4. 格力电器20250627的PB
5. 万科A的估值指标
6. 比亚迪2025-06-27的PE
7. 宁德时代上个交易日的市盈率
8. 招商银行2025年06月27日的PB
9. 五粮液的PE和PB
10. 601318.SH最新估值
```

#### 错误测试用例（5个）
```
1. 茅台PE（错误：应使用完整名称）
2. PE（错误：缺少股票名称）
3. 600519.sh的市盈率（错误：后缀应为大写）
4. 平安PB（错误：有歧义的简称）
5. 明天的PE（错误：未来日期无效）
```

### 6. 涨跌幅排名模板 (pct_chg_ranking)

**功能**: 查询涨跌幅排名前N的股票  
**模式**: `(?:(\d{8}|\d{4}-\d{2}-\d{2}|\d{4}年\d{2}月\d{2}日|今天|昨天|上个交易日))?(?:涨幅|跌幅).*前(\d+)|(?:涨幅|跌幅)最大.*(\d+)`  
**路由**: SQL_ONLY (快速路径)

#### 正向测试用例（10个）
```
1. 今天涨幅前10
2. 昨天跌幅最大的10只股票
3. 20250627涨幅前20
4. 2025-06-27跌幅前5
5. 上个交易日涨幅最大的15只股票
6. 2025年06月27日涨幅前30
7. 涨幅前10的股票
8. 跌幅最大的20只
9. 今日涨幅前50只股票
10. 昨天跌幅前100
```

#### 错误测试用例（5个）
```
1. 涨幅（错误：缺少数量限制）
2. 前10（错误：缺少涨跌幅说明）
3. 茅台涨幅前10（错误：排名查询不应指定个股）
4. 明天涨幅前10（错误：未来日期无效）
5. 涨幅前0（错误：数量必须为正数）
```

### 7. 市值排名模板 (market_cap_ranking)

**功能**: 查询总市值或流通市值排名  
**模式**: `(?:(\d{8}|\d{4}-\d{2}-\d{2}|\d{4}年\d{2}月\d{2}日|今天|昨天|上个交易日))?(?:总市值|(?<!流通)市值).*前(\d+)|最大.*(?:总市值|(?<!流通)市值).*(\d+)`  
**路由**: SQL_ONLY (快速路径)

#### 正向测试用例（10个）
```
1. 总市值前10
2. 昨天市值最大的20只股票
3. 20250627总市值前30
4. 2025-06-27市值前50
5. 上个交易日总市值最大的15只
6. 2025年06月27日市值前100
7. 市值前5的股票
8. 最大市值的10只股票
9. 今日总市值前20
10. 流通市值前10
```

#### 错误测试用例（5个）
```
1. 市值（错误：缺少排名数量）
2. 前20（错误：缺少市值类型说明）
3. 茅台市值前10（错误：排名查询不应指定个股）
4. 明天市值前10（错误：未来日期无效）
5. 市值前-10（错误：数量必须为正数）
```

### 8. 主力净流入排名模板 (money_flow_ranking)

**功能**: 查询主力资金净流入排名  
**模式**: `(?:(\d{8}|\d{4}-\d{2}-\d{2}|\d{4}年\d{2}月\d{2}日|今日|今天|昨天|上个交易日))?(?:(.+?)的)?主力.*净流入.*(?:排行|排名|前(\d+))`  
**路由**: SQL_ONLY (快速路径)

#### 正向测试用例（10个）
```
1. 今天主力净流入排行前10
2. 昨天主力资金净流入前20
3. 20250627主力净流入排名前30
4. 2025-06-27主力资金净流入前15
5. 上个交易日主力净流入前50
6. 2025年06月27日主力资金净流入排行前100
7. 主力净流入前5
8. 主力资金净流入最大的10只
9. 今日主力净流入排名前25
10. 贵州茅台的主力净流入
```

#### 错误测试用例（5个）
```
1. 主力净流入（错误：缺少排名数量）
2. 净流入前10（错误：缺少主力说明）
3. 茅台主力（错误：查询不完整）
4. 明天主力净流入前10（错误：未来日期无效）
5. 主力净流入前0（错误：数量必须为正数）
```

### 9. 成交额排名模板 (amount_ranking)

**功能**: 查询成交额排名  
**模式**: `(?:(\d{8}|\d{4}-\d{2}-\d{2}|\d{4}年\d{2}月\d{2}日|今天|昨天|上个交易日))?成交额.*前(\d+)|成交额最大.*(\d+)`  
**路由**: SQL_ONLY (快速路径)

#### 正向测试用例（10个）
```
1. 今天成交额前10
2. 昨天成交额最大的20只股票
3. 20250627成交额前30
4. 2025-06-27成交额前50
5. 上个交易日成交额最大的15只
6. 2025年06月27日成交额前100
7. 成交额前5的股票
8. 成交额最大的10只股票
9. 今日成交额前25
10. 成交额排名前50
```

#### 错误测试用例（5个）
```
1. 成交额（错误：缺少排名数量）
2. 前10（错误：缺少成交额说明）
3. 茅台成交额前10（错误：排名查询不应指定个股）
4. 明天成交额前10（错误：未来日期无效）
5. 成交额前-5（错误：数量必须为正数）
```

### 10. 板块股票查询模板 (sector_stocks)

**功能**: 查询特定板块的股票列表  
**模式**: `(.+?)板块.*股票|(.+?)行业.*成分股`  
**路由**: SQL_ONLY (LLM路径)

#### 正向测试用例（10个）
```
1. 银行板块的股票
2. 白酒行业的成分股
3. 新能源板块有哪些股票
4. 医药行业的股票列表
5. 房地产板块股票
6. 汽车行业成分股
7. 科技板块的股票有哪些
8. 消费板块股票列表
9. 金融行业的成分股
10. 军工板块包含哪些股票
```

#### 错误测试用例（5个）
```
1. 板块股票（错误：缺少板块名称）
2. 股票（错误：查询不明确）
3. 茅台板块（错误：茅台是公司不是板块）
4. 哪些板块（错误：应该查询特定板块的股票）
5. 板块（错误：查询不完整）
```

## 性能指标

| 模板类型 | 平均响应时间 | 路径类型 | 性能加速比 |
|---------|------------|---------|-----------|
| 股价查询 | 0.02秒 | 快速路径 | 2500x |
| K线查询 | 0.02秒 | 快速路径 | 2500x |
| 成交量查询 | 0.02秒 | 快速路径 | 2500x |
| 估值指标 | 0.02秒 | 快速路径 | 2500x |
| 涨跌幅排名 | 0.02秒 | 快速路径 | 2500x |
| 市值排名 | 0.02秒 | 快速路径 | 2500x |
| 主力净流入 | 0.02秒 | 快速路径 | 2500x |
| 成交额排名 | 0.02秒 | 快速路径 | 2500x |
| 利润查询 | 5-30秒 | LLM路径 | - |
| 板块股票 | 5-30秒 | LLM路径 | - |

## 测试建议

1. **快速路径测试**：重点测试响应时间是否在0.1秒以内
2. **日期解析测试**：验证各种日期格式是否正确转换
3. **错误提示测试**：验证错误输入是否返回友好的提示信息
4. **排名查询测试**：确认排名查询不会触发股票验证
5. **性能对比测试**：对比相同查询在快速路径和LLM路径的响应时间差异

## 注意事项

1. 所有股票名称必须使用完整名称，不支持简称（如"茅台"应为"贵州茅台"）
2. 股票代码后缀必须大写（.SH/.SZ/.BJ）
3. 日期支持多种格式，但必须是有效的历史日期
4. 排名查询的数量必须为正整数
5. 部分查询（如利润查询、板块股票）需要LLM理解，响应时间较长