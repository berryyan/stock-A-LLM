# 多期财务对比分析测试用例

## 测试目标

验证多期财务对比分析功能的正确性、稳定性和边界情况处理能力。

## 测试用例设计

### 1. 功能性测试

#### TC001：正常情况测试
**测试场景**：分析数据完整的大型公司
```
输入查询：
- "分析贵州茅台的多期财务对比"
- "600519.SH的财务对比分析"
- "茅台最近几期的财务变化"

预期结果：
- 成功返回8期财务数据的对比分析
- 包含同比、环比、趋势、波动性分析
- 生成完整的分析报告
```

#### TC002：成长型公司测试
**测试场景**：分析高速成长的科技公司
```
输入查询：
- "比亚迪的多期财务对比"
- "宁德时代的财务变化分析"

预期结果：
- 显示较高的同比增长率
- 趋势分析显示"上升趋势"
- 提示关注增长可持续性
```

#### TC003：周期性公司测试
**测试场景**：分析周期性行业公司
```
输入查询：
- "宝钢股份的多期财务对比"
- "中国石化的财务对比分析"

预期结果：
- 显示明显的周期性波动
- 波动性分析显示"波动较大"
- 建议结合行业周期分析
```

### 2. 边界条件测试

#### TC004：数据不足测试
**测试场景**：新上市或数据缺失的公司
```
输入查询：
- 新上市公司（上市不足2年）
- 数据缺失严重的公司

预期结果：
- 返回错误信息："历史数据不足，无法进行多期对比"
- 不会导致系统崩溃
```

#### TC005：最小数据量测试
**测试场景**：只有2-3期数据的公司
```
预期结果：
- 环比分析正常执行
- 同比分析返回空或提示数据不足
- 趋势分析可能受限
```

### 3. 异常数据测试

#### TC006：财务数据异常测试
**测试场景**：包含异常值的财务数据
```
测试数据特征：
- 某期利润为负
- 现金流大幅波动
- ROE异常（如负值）

预期结果：
- 正确计算增长率（处理负数基数）
- 波动性评级为"波动较大"
- 报告中提示数据异常
```

#### TC007：零值处理测试
**测试场景**：某些财务指标为0
```
测试数据特征：
- 某期营收为0
- 现金流为0

预期结果：
- 增长率计算返回0而非错误
- 不影响其他指标计算
- 报告中说明特殊情况
```

### 4. 性能测试

#### TC008：响应时间测试
**测试标准**：
```
- 正常查询：< 30秒
- 复杂查询：< 45秒
- 并发查询：支持5个并发请求
```

### 5. 查询模式测试

#### TC009：多种表达方式测试
**测试查询变体**：
```
1. "贵州茅台的多期财务对比"
2. "分析600519.SH的财务变化"
3. "茅台最近几期财务表现如何"
4. "比较茅台不同时期的财务数据"
5. "600519财务对比分析"

预期结果：
- 所有查询都能正确识别为comparison类型
- 正确提取股票代码
- 返回相同的分析功能
```

### 6. 数据准确性测试

#### TC010：计算准确性验证
**验证方法**：
```python
# 手动计算验证
1. 同比增长率 = (当期值 - 去年同期值) / |去年同期值| × 100
2. 环比增长率 = (当期值 - 上期值) / |上期值| × 100
3. 标准差计算验证
4. 趋势判断逻辑验证
```

### 7. 报告质量测试

#### TC011：分析报告完整性
**检查项目**：
- [ ] 包含股票名称和代码
- [ ] 显示分析期数
- [ ] 包含核心结论
- [ ] 提供详细数据分析
- [ ] 给出风险提示
- [ ] 提供投资建议

#### TC012：洞察质量测试
**评估标准**：
- 洞察是否基于数据
- 建议是否具体可行
- 风险提示是否充分
- 语言是否专业客观

### 8. 集成测试

#### TC013：与其他分析功能对比
**测试场景**：
```
对同一股票执行：
1. 财务健康度分析
2. 杜邦分析
3. 现金流质量分析
4. 多期财务对比

验证：
- 数据一致性
- 结论互补性
- 无冲突信息
```

## 测试数据准备

### 推荐测试股票

1. **数据完整型**
   - 贵州茅台 (600519.SH)
   - 招商银行 (600036.SH)
   - 中国平安 (601318.SH)

2. **高成长型**
   - 比亚迪 (002594.SZ)
   - 宁德时代 (300750.SZ)

3. **周期型**
   - 宝钢股份 (600019.SH)
   - 中国石化 (600028.SH)

4. **问题数据型**
   - 亏损公司
   - 新上市公司
   - ST股票

## 测试执行建议

1. **测试顺序**
   - 先执行功能性测试，确保基本功能正常
   - 再执行边界和异常测试
   - 最后进行性能和集成测试

2. **回归测试**
   - 每次代码修改后执行核心用例
   - 定期执行完整测试套件

3. **测试记录**
   - 记录每个测试的执行时间
   - 截图保存关键结果
   - 记录发现的问题和改进建议

## 预期测试结果汇总

| 测试类型 | 用例数量 | 预期通过率 |
|---------|---------|-----------|
| 功能性测试 | 3 | 100% |
| 边界条件 | 2 | 100% |
| 异常数据 | 2 | 100% |
| 性能测试 | 1 | 95% |
| 查询模式 | 1 | 100% |
| 数据准确性 | 1 | 100% |
| 报告质量 | 2 | 90% |
| 集成测试 | 1 | 95% |