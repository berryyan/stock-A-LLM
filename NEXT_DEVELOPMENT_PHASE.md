# ä¸‹ä¸€æ­¥å¼€å‘è®¡åˆ’ - Stock Analysis System

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**æ›´æ–°æ—¥æœŸ**: 2025-06-25  
**å½“å‰ç‰ˆæœ¬**: v1.4.2-final (åŠŸèƒ½å®Œæ•´ç‰ˆæœ¬)  
**å½“å‰åˆ†æ”¯**: dev-phase2-technical-analysis  

## ğŸ“‹ ç›®å½•

1. [ç´§æ€¥å¾…åŠäº‹é¡¹](#ç´§æ€¥å¾…åŠäº‹é¡¹)
2. [å¼€å‘ç¯å¢ƒé—®é¢˜](#å¼€å‘ç¯å¢ƒé—®é¢˜)
3. [æµ‹è¯•ç­–ç•¥è§„èŒƒ](#æµ‹è¯•ç­–ç•¥è§„èŒƒ)
4. [Phase 2 æŠ€æœ¯é¢åˆ†æç³»ç»Ÿ](#phase-2-æŠ€æœ¯é¢åˆ†æç³»ç»Ÿ)
5. [åç»­å¼€å‘è·¯çº¿å›¾](#åç»­å¼€å‘è·¯çº¿å›¾)
6. [å·²å®ŒæˆåŠŸèƒ½æ€»ç»“](#å·²å®ŒæˆåŠŸèƒ½æ€»ç»“)

## ç´§æ€¥å¾…åŠäº‹é¡¹

### 1. Claude Codeç¯å¢ƒæ›´æ–° ğŸš¨
**é—®é¢˜**: Auto-update failed Â· Try claude doctor or npm i -g@anthropic-ai/claude-code
**è§£å†³æ–¹æ¡ˆ**: 
```bash
# ç”¨æˆ·éœ€è¦åœ¨æœ¬åœ°æ‰§è¡Œ
npm i -g @anthropic-ai/claude-code
claude doctor
```

### 2. Bashå‘½ä»¤è¶…æ—¶é…ç½® ğŸš¨
**é—®é¢˜**: è„šæœ¬æµ‹è¯•ç»å¸¸è¶…æ—¶ï¼ˆé»˜è®¤2åˆ†é’Ÿï¼‰
**è§£å†³æ–¹æ¡ˆ**:
- ä¸ºé•¿æ—¶é—´è¿è¡Œçš„å‘½ä»¤è®¾ç½®timeoutå‚æ•°ï¼šæœ€å¤§600000msï¼ˆ10åˆ†é’Ÿï¼‰
- å»ºç«‹æµ‹è¯•è„šæœ¬åˆ†ç±»ï¼Œæ˜ç¡®æ‰§è¡Œæ–¹å¼

### 3. é«˜çº§ç½‘é¡µç•Œé¢åŠŸèƒ½ç¡®è®¤ âš¡
**éœ€è¦æ¢å¤çš„WebSocketåŠŸèƒ½**:
- WebSocketå®æ—¶é€šä¿¡æœºåˆ¶ï¼ˆåŸ23ä¸ªå¼•ç”¨â†’å½“å‰0ä¸ªï¼‰
- è‡ªåŠ¨æ–­çº¿é‡è¿åŠŸèƒ½
- å®æ—¶æ‰“å­—æŒ‡ç¤ºå™¨
- æ™ºèƒ½æ¶ˆæ¯æ ¼å¼åŒ–å±•ç¤º

**ç”¨æˆ·éœ€ç¡®è®¤**: æ˜¯å¦éœ€è¦æ¢å¤è¿™äº›é«˜çº§äº¤äº’åŠŸèƒ½ï¼Ÿ

## å¼€å‘ç¯å¢ƒé—®é¢˜

### æµ‹è¯•æ‰§è¡Œç¯å¢ƒè¯´æ˜
ç”±äºWSL2ç¯å¢ƒé™åˆ¶å’ŒWindowså…¼å®¹æ€§è¦æ±‚ï¼Œéœ€è¦æ˜ç¡®ä¸åŒç±»å‹æµ‹è¯•çš„æ‰§è¡Œæ–¹å¼ï¼š

#### 1. Claude Codeå¯ç›´æ¥æ‰§è¡Œçš„æµ‹è¯•
```bash
# æ•°æ®åº“è¿æ¥æµ‹è¯•
python scripts/tests/test_databases.py

# ç®€å•åŠŸèƒ½éªŒè¯
python quick_test.py
python simple_date_test.py

# æ•°æ®åˆ†æè„šæœ¬
python database_structure_analyzer.py
python check_available_dates.py
```

#### 2. éœ€è¦ç”¨æˆ·åœ¨Windowsæ‰§è¡Œçš„æµ‹è¯•
```bash
# Windows Anacondaç¯å¢ƒå¯åŠ¨API
(stock_analysis_env) python -m uvicorn api.main:app --reload --host 0.0.0.0 --port 8000

# ç»¼åˆåŠŸèƒ½æµ‹è¯•ï¼ˆéœ€è¦APIè¿è¡Œï¼‰
(stock_analysis_env) python baseline_test.py
(stock_analysis_env) python comprehensive_verification.py
(stock_analysis_env) python test_financial_agent.py
(stock_analysis_env) python test_money_flow_analysis.py
```

#### 3. ç½‘é¡µç‰ˆæµ‹è¯•ï¼ˆéœ€è¦ç”¨æˆ·æ‰‹åŠ¨æµ‹è¯•ï¼‰
- è®¿é—® http://localhost:8000
- æŒ‰ç…§ docs/testing/WEB_FUNCTIONAL_TEST_GUIDE.md æ‰§è¡Œæµ‹è¯•
- APIæ–‡æ¡£æµ‹è¯•ï¼šhttp://localhost:8000/docs

### Bashè¶…æ—¶é…ç½®ç­–ç•¥
```python
# çŸ­æ—¶é—´å‘½ä»¤ï¼ˆ< 30ç§’ï¼‰
bash_result = Bash(command="git status")

# ä¸­ç­‰æ—¶é—´å‘½ä»¤ï¼ˆ< 2åˆ†é’Ÿï¼‰
bash_result = Bash(command="python quick_test.py", timeout=120000)

# é•¿æ—¶é—´å‘½ä»¤ï¼ˆ< 10åˆ†é’Ÿï¼‰
bash_result = Bash(command="python comprehensive_test.py", timeout=600000)
```

## æµ‹è¯•ç­–ç•¥è§„èŒƒ

### ä¸‰å±‚æµ‹è¯•ä½“ç³»

#### 1. å•å…ƒæµ‹è¯•ï¼ˆClaude Codeæ‰§è¡Œï¼‰
- æ•°æ®åº“è¿æ¥éªŒè¯
- å·¥å…·å‡½æ•°æµ‹è¯•
- æ¨¡å—å¯¼å…¥æ£€æŸ¥
- **æ‰§è¡Œæ–¹å¼**: Claude Codeç›´æ¥è¿è¡Œ

#### 2. é›†æˆæµ‹è¯•ï¼ˆWindows APIç¯å¢ƒï¼‰
- APIç«¯ç‚¹æµ‹è¯•
- AgentåŠŸèƒ½éªŒè¯
- ç«¯åˆ°ç«¯æµç¨‹æµ‹è¯•
- **æ‰§è¡Œæ–¹å¼**: æç¤ºç”¨æˆ·åœ¨Windowsè¿è¡Œ

#### 3. ç”¨æˆ·éªŒæ”¶æµ‹è¯•ï¼ˆç½‘é¡µç•Œé¢ï¼‰
- åŠŸèƒ½å®Œæ•´æ€§éªŒè¯
- ç”¨æˆ·ä½“éªŒæµ‹è¯•
- æ€§èƒ½åŸºå‡†éªŒè¯
- **æ‰§è¡Œæ–¹å¼**: æç¤ºç”¨æˆ·æ‰‹åŠ¨æµ‹è¯•

### æµ‹è¯•æç¤ºæ¨¡æ¿
```python
# Claude Codeä½¿ç”¨ç¤ºä¾‹
if test_type == "integration":
    print("âš ï¸ æ­¤æµ‹è¯•éœ€è¦APIè¿è¡Œ")
    print("è¯·åœ¨Windowsç¯å¢ƒæ‰§è¡Œï¼š")
    print("1. å¯åŠ¨API: python -m uvicorn api.main:app --reload")
    print("2. è¿è¡Œæµ‹è¯•: python {test_file}")
elif test_type == "web":
    print("ğŸŒ æ­¤ä¸ºç½‘é¡µç‰ˆæµ‹è¯•")
    print("è¯·æ‰“å¼€æµè§ˆå™¨è®¿é—® http://localhost:8000")
    print("æŒ‰ç…§æµ‹è¯•æŒ‡å—æ‰§è¡Œæ‰‹åŠ¨æµ‹è¯•")
```

## Phase 2 æŠ€æœ¯é¢åˆ†æç³»ç»Ÿ

### å¼€å‘æ¦‚è¿°
- **ç›®æ ‡**: æ„å»ºä¸“ä¸šçš„æŠ€æœ¯é¢åˆ†æç³»ç»Ÿï¼Œä¸å·²å®Œæˆçš„åŸºæœ¬é¢åˆ†æå½¢æˆäº’è¡¥
- **é¢„è®¡æ—¶é—´**: 3å‘¨
- **ä¼˜å…ˆçº§**: æœ€é«˜

### Week 1: æŠ€æœ¯æŒ‡æ ‡è®¡ç®—æ¨¡å— (utils/technical_indicators.py)

#### æ ¸å¿ƒæŒ‡æ ‡å®ç°
1. **è¶‹åŠ¿æŒ‡æ ‡**
   - SMA/EMAï¼ˆç®€å•/æŒ‡æ•°ç§»åŠ¨å¹³å‡ï¼‰
   - MACDï¼ˆå¹³æ»‘å¼‚åŒç§»åŠ¨å¹³å‡çº¿ï¼‰
   - å¸ƒæ—å¸¦ï¼ˆBollinger Bandsï¼‰

2. **åŠ¨é‡æŒ‡æ ‡**
   - RSIï¼ˆç›¸å¯¹å¼ºå¼±æŒ‡æ ‡ï¼‰
   - KDJï¼ˆéšæœºæŒ‡æ ‡ï¼‰
   - ROCï¼ˆå˜åŠ¨ç‡ï¼‰

3. **æˆäº¤é‡æŒ‡æ ‡**
   - OBVï¼ˆèƒ½é‡æ½®ï¼‰
   - æˆäº¤é‡åŠ æƒå¹³å‡ä»·ï¼ˆVWAPï¼‰
   - é‡æ¯”æŒ‡æ ‡

4. **æ³¢åŠ¨ç‡æŒ‡æ ‡**
   - ATRï¼ˆçœŸå®æ³¢å¹…ï¼‰
   - æ ‡å‡†å·®
   - å†å²æ³¢åŠ¨ç‡

### Week 2: TechnicalAnalysisAgentå¼€å‘

#### æ ¸å¿ƒåŠŸèƒ½
1. **è¶‹åŠ¿åˆ†æ**
   - ä¸»è¶‹åŠ¿åˆ¤æ–­ï¼ˆä¸Šå‡/ä¸‹é™/æ¨ªç›˜ï¼‰
   - è¶‹åŠ¿å¼ºåº¦è¯„ä¼°
   - è¶‹åŠ¿è½¬æŠ˜ç‚¹è¯†åˆ«

2. **å½¢æ€è¯†åˆ«**
   - ç»å…¸Kçº¿å½¢æ€ï¼ˆé”¤å­çº¿ã€åå­—æ˜Ÿç­‰ï¼‰
   - å›¾è¡¨å½¢æ€ï¼ˆå¤´è‚©é¡¶ã€åŒåº•ç­‰ï¼‰
   - çªç ´å½¢æ€è¯†åˆ«

3. **æ”¯æ’‘é˜»åŠ›åˆ†æ**
   - åŠ¨æ€æ”¯æ’‘/é˜»åŠ›ä½è®¡ç®—
   - é‡è¦ä»·æ ¼åŒºé—´æ ‡è®°
   - çªç ´æ¦‚ç‡è¯„ä¼°

4. **äº¤æ˜“ä¿¡å·ç”Ÿæˆ**
   - ä¹°å…¥/å–å‡ºä¿¡å·
   - ä¿¡å·å¼ºåº¦è¯„çº§
   - é£é™©æç¤º

### Week 3: APIé›†æˆå’Œæµ‹è¯•

#### é›†æˆä»»åŠ¡
1. **APIç«¯ç‚¹å¼€å‘**
   ```python
   POST /technical-analysis
   {
       "ts_code": "600519.SH",
       "analysis_type": "comprehensive",
       "period": 30
   }
   ```

2. **Hybrid Agenté›†æˆ**
   - æ·»åŠ TECHNICALæŸ¥è¯¢ç±»å‹
   - æ™ºèƒ½è·¯ç”±åˆ°TechnicalAgent

3. **å‰ç«¯ç•Œé¢æ›´æ–°**
   - æ·»åŠ æŠ€æœ¯åˆ†æå¿«æ·æŒ‰é’®
   - å›¾è¡¨å±•ç¤ºæ”¯æŒï¼ˆå¯é€‰ï¼‰

## åç»­å¼€å‘è·¯çº¿å›¾

### Phase 3: æ–‡æ¡£æ™ºèƒ½åˆ†æ (2-3å‘¨)
**ç›®æ ‡**: æ·±åº¦è§£è¯»è´¢æŠ¥å’Œå…¬å‘Šå†…å®¹
- å¹´æŠ¥å­£æŠ¥å…³é”®ä¿¡æ¯æå–
- ä¸»é¢˜æŠ•èµ„æœºä¼šå‘ç°ï¼ˆAIã€æ–°èƒ½æºã€ç”Ÿç‰©åŒ»è¯ï¼‰
- æ”¿ç­–å½±å“åˆ†æ
- è¡Œä¸šè¶‹åŠ¿è¯†åˆ«
- äº‹ä»¶é©±åŠ¨åˆ†æ

**æ–°å¢ç»„ä»¶**:
- DocumentAnalysisAgent
- ThemeDiscoveryEngine
- PolicyImpactAnalyzer

### Phase 4: ç»¼åˆå†³ç­–æ”¯æŒ (2-3å‘¨)
**ç›®æ ‡**: å¤šç»´åº¦æŠ•èµ„å†³ç­–ç³»ç»Ÿ
- ç»¼åˆè¯„åˆ†ç³»ç»Ÿï¼ˆåŸºæœ¬é¢70% + æŠ€æœ¯é¢20% + æ¶ˆæ¯é¢10%ï¼‰
- æŠ•èµ„ç»„åˆä¼˜åŒ–å»ºè®®
- é£é™©åˆ†æ•£ç­–ç•¥
- åŠ¨æ€å†å¹³è¡¡æé†’
- å†å²å›æµ‹åˆ†æ

**æ–°å¢ç»„ä»¶**:
- PortfolioAgent
- RiskAnalysisEngine
- BacktestingSystem

### Phase 5: ä¼°å€¼åˆ†æç³»ç»Ÿ (1-2å‘¨)
**ç›®æ ‡**: ä¸“ä¸šä¼°å€¼å’Œé€‰è‚¡
- PE/PBå†å²åˆ†ä½æ•°
- PEGä¼°å€¼åˆç†æ€§
- DCFæ¨¡å‹ï¼ˆå¯é€‰ï¼‰
- ç›¸å¯¹ä¼°å€¼åˆ†æ
- è‚¡æ¯ç‡åˆ†æ

**æ–°å¢ç»„ä»¶**:
- ValuationAgent
- DividendAnalyzer

### å…¶ä»–æ”¹è¿›ä»»åŠ¡

#### çŸ­æœŸä»»åŠ¡ï¼ˆ1å‘¨å†…ï¼‰
- [ ] æ€§èƒ½ç›‘æ§ä»ªè¡¨æ¿
- [ ] APIæ–‡æ¡£å®Œå–„
- [ ] éƒ¨ç½²æŒ‡å—æ›´æ–°
- [ ] Claude Codeä½¿ç”¨æœ€ä½³å®è·µæ–‡æ¡£

#### ä¸­é•¿æœŸä»»åŠ¡
- [ ] Redisç¼“å­˜å±‚å®ç°
- [ ] æ›´å¤šæŸ¥è¯¢æ¨¡æ¿
- [ ] å®æ—¶æ•°æ®æ¨é€
- [ ] CI/CDæµç¨‹é›†æˆ
- [ ] å¤šè¯­è¨€æ”¯æŒï¼ˆè‹±æ–‡ç‰ˆï¼‰

## å·²å®ŒæˆåŠŸèƒ½æ€»ç»“

### v1.4.2-final åŠŸèƒ½æ¸…å• âœ…

#### æ ¸å¿ƒæŸ¥è¯¢ç³»ç»Ÿ
- **SQLæŸ¥è¯¢**: è‚¡ä»·ã€å¸‚å€¼ã€è´¢åŠ¡æŒ‡æ ‡æŸ¥è¯¢
- **RAGæŸ¥è¯¢**: æ–‡æ¡£è¯­ä¹‰æœç´¢ï¼ˆ95,662+å‘é‡ï¼‰
- **æ··åˆæŸ¥è¯¢**: æ™ºèƒ½è·¯ç”±å’Œç»„åˆåˆ†æ

#### Phase 1: æ·±åº¦è´¢åŠ¡åˆ†æ âœ…
- **è´¢åŠ¡å¥åº·åº¦è¯„åˆ†**: AAA-CCCä¸“ä¸šè¯„çº§ç³»ç»Ÿ
- **æœé‚¦åˆ†æ**: ROEä¸‰å› ç´ åˆ†è§£
- **ç°é‡‘æµè´¨é‡**: A-Dçº§è´¨é‡è¯„ä¼°
- **å¤šæœŸå¯¹æ¯”**: åŒæ¯”ç¯æ¯”è¶‹åŠ¿åˆ†æ

#### Phase 2: èµ„é‡‘æµå‘åˆ†æ âœ…
- **ä¸»åŠ›èµ„é‡‘ç›‘æ§**: å¤§å•+è¶…å¤§å•å‡€æµå‘
- **è¶…å¤§å•è¡Œä¸ºè¯†åˆ«**: å»ºä»“/å‡ä»“/æ´—ç›˜æ¨¡å¼
- **å››çº§èµ„é‡‘åˆ†å¸ƒ**: æœºæ„/å¤§æˆ·/ä¸­æˆ·/æ•£æˆ·
- **ä¸“ä¸šè¯„ä¼°æŠ¥å‘Š**: æµå‘å¼ºåº¦å’Œä¸€è‡´æ€§è¯„åˆ†

#### æ™ºèƒ½æ—¥æœŸè§£æ v2.0 âœ…
- **è‡ªç„¶è¯­è¨€è¯†åˆ«**: "æœ€æ–°"ã€"æœ€è¿‘"ã€"å»å¹´åŒæœŸ"
- **æ—¶é—´ç‚¹vsæ—¶é—´æ®µ**: ç²¾å‡†åŒºåˆ†æŸ¥è¯¢æ„å›¾
- **ä¸“ä¸šäº¤æ˜“æ—¥è®¡ç®—**: è€ƒè™‘èŠ‚å‡æ—¥å’Œåœç‰Œ
- **å¤šå±‚ç¼“å­˜ä¼˜åŒ–**: 1å°æ—¶TTLç¼“å­˜

#### ç³»ç»Ÿç‰¹æ€§
- **Windowså…¼å®¹æ€§**: 100%æ”¯æŒ
- **é”™è¯¯å¤„ç†å®Œå–„**: ç»Ÿä¸€å“åº”æ ¼å¼
- **æ€§èƒ½ä¼˜åŒ–**: å¹¶è¡ŒæŸ¥è¯¢ã€æ™ºèƒ½ç¼“å­˜
- **æµ‹è¯•ä½“ç³»**: è„šæœ¬æµ‹è¯•+ç½‘é¡µæµ‹è¯•åŒé‡éªŒè¯

### æŠ€æœ¯æ ˆ
- **åç«¯**: FastAPI + LangChain + MySQL + Milvus
- **æ¨¡å‹**: DeepSeek Chat + BGE-M3 Embedding
- **å‰ç«¯**: HTML + JavaScript + HTTP API
- **éƒ¨ç½²**: Windows/Linuxå…¼å®¹

---

**é‡è¦æé†’**: 
1. å¼€å§‹æ–°åŠŸèƒ½å¼€å‘å‰ï¼Œè¯·å…ˆè§£å†³Claude Codeæ›´æ–°é—®é¢˜
2. ç¡®è®¤æµ‹è¯•ç­–ç•¥ï¼Œé¿å…è¶…æ—¶é—®é¢˜
3. æ˜ç¡®WebSocketåŠŸèƒ½éœ€æ±‚å†è¿›è¡Œæ¢å¤
4. æ‰€æœ‰æ–°åŠŸèƒ½éƒ½éœ€è¦åŒæ—¶æ›´æ–°è„šæœ¬æµ‹è¯•å’Œç½‘é¡µæµ‹è¯•ç”¨ä¾‹