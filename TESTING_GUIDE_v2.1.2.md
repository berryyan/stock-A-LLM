# 测试指导建议 - v2.1.2

**日期**: 2025-06-30  
**当前版本**: v2.1.2 (SQL Agent快速模板完成)

## 一、测试重点

### 1. SQL Agent快速模板测试（最高优先级）

#### 测试脚本
```bash
# 运行快速模板综合测试
source venv/bin/activate && python test_sql_quick_templates.py
```

#### 重点验证项
- ✅ 快速路径响应时间 < 0.1秒
- ✅ 排名查询不触发股票验证
- ✅ 格式化输出的专业性
- ✅ 模板匹配准确性

#### 建议测试用例
1. **股价查询**（快速路径）
   - "贵州茅台最新股价"
   - "中国平安今天的价格"

2. **估值指标**（快速路径）
   - "贵州茅台的PE和PB"
   - "中国平安的市盈率"

3. **排名查询**（快速路径）
   - "今天涨幅最大的前10只股票"
   - "总市值最大的前20只股票"

4. **历史K线**（快速路径）
   - "贵州茅台最近90天的K线走势"

### 2. 路由机制测试

#### 测试脚本
```bash
# 测试增强路由功能
source venv/bin/activate && python test_enhanced_routing.py
```

#### 验证要点
- 触发词路由（最高优先级）
- 模板匹配路由
- 配置化管理（无硬编码）

### 3. 回归测试

#### API功能测试
```bash
# 启动API服务
python -m uvicorn api.main:app --reload --host 0.0.0.0 --port 8000

# 测试基础功能
curl -X POST http://localhost:8000/api/query \
  -H "Content-Type: application/json" \
  -d '{"question": "贵州茅台最新股价", "query_type": "sql"}'
```

#### 前端集成测试
```bash
# 启动前端（Windows环境）
cd frontend && npm run dev

# 测试场景
1. SQL快速查询
2. 排名查询（验证不触发股票验证）
3. 混合查询
```

## 二、性能基准

### 期望性能指标
| 查询类型 | 快速路径 | LLM路径 | 加速比 |
|---------|---------|---------|--------|
| 股价查询 | 0.02s | 30s+ | 1500x+ |
| 估值指标 | 0.02s | 25s+ | 1250x+ |
| 排名查询 | 0.02s | 50s+ | 2500x+ |
| K线数据 | 0.02s | 40s+ | 2000x+ |

### 系统负载测试
```bash
# 并发测试（可选）
python scripts/tests/concurrent_test.py
```

## 三、问题排查

### 常见问题
1. **快速路径未生效**
   - 检查模板匹配是否准确
   - 查看日志确认路由决策

2. **排名查询失败**
   - 确认已禁用股票验证
   - 检查SQL语法正确性

3. **格式化输出异常**
   - 验证SQLTemplates格式化方法
   - 检查数据类型转换

## 四、测试记录模板

```markdown
### 测试日期: 2025-06-30
### 测试版本: v2.1.2

#### SQL Agent快速模板测试
- [ ] test_sql_quick_templates.py 通过率: __/9
- [ ] 快速路径使用率: __/9
- [ ] 平均响应时间: __秒
- [ ] 加速比: __x

#### 路由机制测试
- [ ] 触发词路由: 正常/异常
- [ ] 模板匹配: 正常/异常
- [ ] 配置化管理: 已验证

#### 问题记录
1. 
2. 

#### 改进建议
1. 
2. 
```

## 五、测试通过标准

1. **功能测试**: 所有快速模板正常工作
2. **性能测试**: 快速路径响应 < 0.1秒
3. **准确性测试**: 路由决策100%准确
4. **回归测试**: 现有功能无退化

---

测试完成后，请记录结果并准备进入Phase 2开发。