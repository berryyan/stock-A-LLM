#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Money Flow Agent 配置模块
包含术语映射、路由规则等配置
"""

# 资金类型术语映射
FUND_TYPE_MAPPING = {
    # 主力资金相关
    '机构资金': '超大单资金',
    '机构': '超大单',
    '大资金': '主力资金',
    '主力': '主力资金',
    '庄家': '主力资金',
    '热钱': '主力资金',
    '聪明钱': '主力资金',
    
    # 游资相关
    '游资': '主力资金',
    '短线资金': '主力资金',
    '活跃资金': '主力资金',
    
    # 散户相关
    '散户资金': '小单资金',
    '散户': '小单',
    '小散': '小单',
    '韭菜': '小单',
    
    # 其他映射
    '大户': '大单',
    '中户': '中单',
    '小户': '小单'
}

# SQL路由模式（这些查询应该路由到SQL Agent）
SQL_ROUTE_PATTERNS = [
    # 排名查询 - 包括排行榜
    r"(主力|超大单|大单|中单|小单|资金).*(排名|排行|TOP|top|榜)",
    r"(净流入|净流出).*(排名|排行|TOP|top|前\d+)",
    r"^(主力|超大单|大单|中单|小单).*排行榜$",
    
    # 时间+简单查询（不含分析词）
    r".*(今天|昨天|最新|现在)(的)?(主力|超大单|大单|中单|小单)(?!资金.*(分析|评估|研究|如何|怎么))",
    
    # 简单数据查询（不包含分析词）
    r"^(?!.*(?:分析|评估|研究|解析|判断|如何)).*?(的)?(主力|超大单|大单|中单|小单)资金$",
    
    # 板块简单查询（不包含分析词）
    r"^(?!.*(?:分析|评估|研究|解析|判断)).*?板块(的)?(主力|超大单|大单|中单|小单)?资金?(流向|流入|流出)?$",
    r"^(?!.*(?:分析|评估|研究|解析|判断)).*?板块(的)?(主力|超大单|大单|中单|小单)$",
    r"^(?!.*(?:分析|评估|研究|解析|判断)).*?板块(主力)?(净流入|净流出)$"
]

# 深度分析模式（这些查询需要Money Flow Agent处理）
ANALYSIS_PATTERNS = [
    # 分析关键词开头
    r"^(分析|评估|研究|解析|判断)",
    # 行为模式关键词
    r".*(建仓|减仓|洗盘|吸筹|出货|控盘)",
    # 深度分析需求
    r".*(如何看待|怎么看|意味着什么|说明了什么)",
    # 趋势分析
    r".*(趋势|走势|未来|预测|展望)",
    # 对比分析
    r".*(对比|比较|差异|区别)",
    # 深度分析关键词
    r".*(深度分析|详细分析|全面分析)",
    # 新增：动词+资金组合
    r"(研究|了解|查看).*(资金|主力)",
    # 新增：资金+动向/趋势
    r"(资金|主力).*(趋势|动向|走势)",
    # 新增：疑问句式
    r"(如何|怎么).*(资金|主力)",
    r"(资金|主力).*(如何|怎么样|怎样)",
    # 新增：意图分析
    r".*意味着.*",
    r".*说明了.*"
]

# 资金流向相关关键词
MONEY_FLOW_KEYWORDS = [
    '资金', '主力', '超大单', '大单', '中单', '小单',
    '净流入', '净流出', '流入', '流出', '买入', '卖出',
    '建仓', '减仓', '洗盘', '吸筹', '出货', '控盘',
    '资金流向', '资金动向', '资金趋势', '资金行为',
    # 新增关键词
    '主力行为', '机构行为', '热钱', '游资', '散户', '机构', '大资金',
    '洗盘迹象', '吸筹行为', '控盘程度',
    # 补充遗漏的关键词
    '趋势', '动向', '走势', '迹象', '差异', '对比',
    '意味', '预测', '未来'
]

# 行为模式定义
BEHAVIOR_PATTERNS = {
    '建仓': {
        'keywords': ['建仓', '吸筹', '收集'],
        'description': '主力资金持续流入，可能在建立仓位'
    },
    '减仓': {
        'keywords': ['减仓', '出货', '派发'],
        'description': '主力资金持续流出，可能在减少仓位'
    },
    '洗盘': {
        'keywords': ['洗盘', '震荡', '整理'],
        'description': '资金流向反复，可能在清洗浮筹'
    },
    '控盘': {
        'keywords': ['控盘', '锁仓', '高控'],
        'description': '主力资金占比很高，控制力强'
    }
}

# 板块名称标准化映射
# 注意：这里只处理用户常用简称到数据库实际名称的映射
SECTOR_NAME_NORMALIZATION = {
    # 暂时保留为空，因为数据库中的板块名称就是标准名称
    # 如果用户习惯说"地产"指代"房地产开发"，可以添加：
    # '地产': '房地产开发',
    # '房产': '房地产服务',
}